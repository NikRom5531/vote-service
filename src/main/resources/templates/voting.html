<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Голосование: [[${votingSession.title}]]</title>
</head>
<body>

<!-- Общий заголовок -->
<h1>[[${votingSession.title}]]</h1>

<!-- Блок для закрытых голосований без проверки пароля -->
<div th:if="${not votingSession.open and (questions == null or questions.empty)}">
    <div th:if="${param.error}" style="color: red">
        Неверный пароль!
    </div>

    <form th:action="@{/votings/verify-password}" method="post">
        <input type="hidden" name="votingId" th:value="${votingSession.id}">
        <label>Введите пароль для доступа:</label>
        <input type="password" name="password" required>
        <button type="submit">Продолжить</button>
    </form>
</div>

<!-- Основной контент -->
<div th:if="${votingSession.open or (not votingSession.open and questions != null and not questions.empty)}">
    <!-- Общие параметры голосования -->
    <p th:if="${votingSession.endTime}">Голосование завершится: [[${votingSession.endTime}]]</p>
    <p th:if="${votingSession.maxVotes}">Максимальное количество голосов: [[${votingSession.maxVotes}]]</p>

    <!-- Форма голосования -->
    <form th:action="@{/votes/vote}" method="post">
        <input type="hidden" name="votingId" th:value="${votingSession.id}">

        <!-- Поле для имени -->
        <div th:unless="${votingSession.anonymous}">
            <label>Ваше имя:</label>
            <input type="text" name="voterName" required>
        </div>

        <!-- Вопросы -->
        <div th:each="question : ${questions}">
            <h3>[[${question.text}]]</h3>

            <!-- Варианты ответов -->
            <div th:each="option : ${question.answerVariant}">
                <input th:if="${question.answerType.name() == 'MULTIPLE_CHOICE'}"
                       type="checkbox"
                       th:name="|selectedAnswers[${question.id}]|"
                       th:value="${option}">

                <input th:if="${question.answerType.name() == 'SINGLE_CHOICE'}"
                       type="radio"
                       th:name="|selectedAnswers[${question.id}]|"
                       th:value="${option}"
                       required>

                <label>[[${option}]]</label>
            </div>
        </div>

        <button type="submit">Проголосовать</button>
    </form>
</div>

</body>
</html>